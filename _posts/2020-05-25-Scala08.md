---
layout:     post
title:      "[Scala] 模式匹配"
subtitle:   "Scala-2.11.8"
date:       2020-05-24 10:57:00
author:     "Backspace"
header-img: "img/post-bg-apple-event-2015.jpg"
catalog:      true
tags:
    - Scala
---

### 基本语法

模式匹配语法中，采用match关键字声明，每个分支采用case关键字进行声明，当需要匹配时，会从第一个case分支开始，如果匹配成功，那么执行对应的逻辑代码，如果匹配不成功，继续执行下一个分支进行判断。如果所有case都不匹配，那么会执行case _分支，类似于Java中default语句

```scala
object ScalaMatch{
  def main(args: Array[String]): Unit = {
​    var a: Int = 10
​    var b: Int = 20
​    var operator: Char = 'd'
​    var result = operator match {
​      case '+' => a + b
​      case '-' => a - b
​      case '*' => a * b
​      case '/' => a / b
​       case _ => "illegal"
​    }
​    println(result)
  }
}
```

------

### 匹配规则

-  scala中的模式匹配没有break。使用大括号表示逻辑执行范围
- scala中执行分支，不需要break语法，两个case之间的代码执行完成后，自动跳出
- scala执行的时候，会首先判断case分支，然后再判断取值
- scala执行的时候，如果没有能够匹配成功的分支，那么会出现错误：scala.MatchError
- match表达式语法存在返回值，返回值为满足条件分支的最后一行代码的结果

1. 匹配常量

   ```scala
   def describe(x: Any) = x match {
     case 5 => "Int five"
     case "hello" => "String hello"
     case true => "Boolean true"
     case '+' => "Char +"
   }
   ```

2. 匹配类型

   ```scala
   def describe(x: Any) = x match {
     case i: Int => "Int"
     case s: String => "String hello"
     case m: List[_] => "List"
     case c: Array[Int] => "Array[Int]"
     case someThing => "something else " + someThing
   }
   ```

3. 匹配数组

   ```scala
   for (arr <- Array(Array(0), Array(1, 0), Array(0, 1, 0), Array(1, 1, 0), Array(1, 1, 0, 1), Array("hello", 90))) { // 对一个数组集合进行遍历
     val result = arr match {
   ​    case Array(0) => "0" //匹配Array(0) 这个数组
   ​    case Array(x, y) => x + "," + y //匹配有两个元素的数组，然后将将元素值赋给对应的x,y
   ​    case Array(0, _*) => "以0开头的数组" //匹配以0开头和数组
   ​    case _ => "something else"
     }
     println("result = " + result)
   }
   ```

4. 匹配列表

   ```scala
   for (list <- Array(List(0), List(1, 0), List(0, 0, 0), List(1, 0, 0), List(88))) {
     val result = list match {
   ​    case List(0) => "0" //匹配List(0)
   ​    case List(x, y) => x + "," + y //匹配有两个元素的List
   ​    case List(0, _*) => "0 ..."
   ​    case _ => "something else"
     }
     println(result)
   }
   val list: List[Int] = List(1, 2, 5, 6, 7)
   list match {
     case first :: second :: rest => println(first + "-" + second + "-" + rest)
     case _ => println("something else")
   }
   ```

5. 匹配元组

   ```scala
   for (tuple <- Array((0, 1), (1, 0), (1, 1), (1, 0, 2))) {
     val result = tuple match {
   ​    case (0, _) => "0 ..." //是第一个元素是0的元组
   ​    case (y, 0) => "" + y + "0" // 匹配后一个元素是0的对偶元组
   ​    case (a, b) => "" + a + " " + b
   ​    case _ => "something else" //默认
     }
     println(result)
   }
   ```

6. 匹配对象

   ```scala
   class User(val name: String, val age: Int)
   object User{
     def apply(name: String, age: Int): User = new User(name, age)
     def unapply(user: User): Option[(String, Int)] = {
   ​    if (user == null)
   ​      None
   ​    else
   ​      Some(user.name, user.age)
     }
   }
   val user: User = User("zhangsan", 11)
   val result = user match {
     case User("zhangsan", 11) => "yes"
     case _ => "no"
   }
   ```

7. 样例类

   

------

### 应用场景

1. 变量声明
2. 循环匹配
3. 函数参数

------

### 偏函数

1. 基本语法
2. 案例实操



